Final merged version

Cleanup improvement
